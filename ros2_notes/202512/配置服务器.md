# 0 HTTPï¼ˆNginxï¼Œæµè§ˆå™¨ç›´è¿ï¼‰ğŸŒ

é€‚åˆå…¬å¼€ / åªè¯»ä¸‹è½½ï¼Œæµè§ˆå™¨ /curl/wget å‡å¯è·å–ï¼›å¯åŠ  Basic Auth é™åˆ¶è®¿é—®ã€‚

# 1 å®‰è£… Nginx å¹¶åˆ›å»ºä¸‹è½½ç›®å½•ï¼š

sudo apt install -y nginx
sudo mkdir -p /srv/http-downloads
sudo chown www-data:www-data /srv/http-downloads  # Nginx æƒé™

# 2 é…ç½® Nginx ç«™ç‚¹

ç¤ºä¾‹ï¼š/etc/nginx/sites-available/downloadsï¼‰ï¼š

sudo nano /etc/nginx/sites-available/downloads

å†…å®¹ï¼š

    server {
        listen 80;
        #server_name _;  # æˆ–å¡«æœåŠ¡å™¨ IP
        server_name 192.168.1.135;  # æˆ–å¡«æœåŠ¡å™¨ IP
        root /srv/http-downloads;
        autoindex on;  # å…è®¸ç›®å½•æµè§ˆ

        location / {
            try_files $uri $uri/ =404;
        }
    }

# 3 å¯ç”¨ç«™ç‚¹å¹¶é‡å¯ Nginx

sudo ln -s /etc/nginx/sites-available/downloads /etc/nginx/sites-enabled/
sudo nginx -t  # æ£€æŸ¥é…ç½®
sudo systemctl restart nginx
sudo ufw allow 80/tcp  # æ”¾è¡Œ 80 ç«¯å£

# 4 æµ‹è¯•

æµ‹è¯•ï¼šæµè§ˆå™¨è®¿é—® http:// æœåŠ¡å™¨ IP â†’ ä¸Šä¼ æ–‡ä»¶åˆ° /srv/http-downloads å³å¯ä¸‹è½½ã€‚

è¿›é˜¶ï¼ˆBasic Authï¼‰ï¼šç”¨ htpasswd ç”Ÿæˆå¯†ç æ–‡ä»¶ï¼Œåœ¨ Nginx é…ç½®ä¸­æ·»åŠ  auth_basic å’Œ auth_basic_user_fileï¼Œé™åˆ¶è®¿é—®ã€‚


# 5 é‡åˆ°çš„é—®é¢˜

sudo systemctl restart nginx  # é‡å¯ Nginxï¼Œè­¦å‘Šæ¶ˆå¤±

å°† server_name _; æ”¹ä¸ºæœåŠ¡å™¨çš„å®é™… IPï¼ˆå…ˆæ‰§è¡Œ ip a æŸ¥çœ‹å±€åŸŸç½‘ IPï¼Œå¦‚ 192.168.1.100ï¼‰


ä¸€ã€é—®é¢˜ 1ï¼šè½¯é“¾æ¥å·²å­˜åœ¨ï¼ˆln: failed to create symbolic link... File existsï¼‰
åŸå› 
ä½ ä¹‹å‰å·²ç»æ‰§è¡Œè¿‡ ln -s å‘½ä»¤åˆ›å»ºäº† /etc/nginx/sites-enabled/downloads è½¯é“¾æ¥ï¼Œå†æ¬¡æ‰§è¡Œä¼šæç¤ºæ–‡ä»¶å·²å­˜åœ¨ï¼ˆNginx ä¸å…è®¸é‡å¤åˆ›å»ºåŒåè½¯é“¾æ¥ï¼‰ã€‚
è§£å†³ï¼ˆæ— éœ€é‡æ–°åˆ›å»ºï¼Œåªéœ€ç¡®è®¤è½¯é“¾æ¥æœ‰æ•ˆï¼‰

    æ£€æŸ¥è½¯é“¾æ¥æ˜¯å¦æ­£ç¡®æŒ‡å‘ç›®æ ‡é…ç½®æ–‡ä»¶ï¼š
    bash

Run

ls -l /etc/nginx/sites-enabled/downloads

âœ… æ­£ç¡®è¾“å‡ºï¼ˆæŒ‡å‘ sites-available ä¸‹çš„ downloadsï¼‰ï¼š
plaintext

lrwxrwxrwx 1 root root 34 æœˆ  æ—¥ æ—¶:åˆ† /etc/nginx/sites-enabled/downloads -> /etc/nginx/sites-available/downloads

âŒ è‹¥è¾“å‡ºå¼‚å¸¸ï¼ˆå¦‚æŒ‡å‘ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼‰ï¼Œå…ˆåˆ é™¤æ—§è½¯é“¾æ¥å†é‡å»ºï¼š
bash
Run

sudo rm /etc/nginx/sites-enabled/downloads  # åˆ é™¤æ—§é“¾æ¥
sudo ln -s /etc/nginx/sites-available/downloads /etc/nginx/sites-enabled/  # é‡å»º


---

æ–¹æ¡ˆ 2ï¼šç»™ä½ çš„é…ç½®æŒ‡å®šå”¯ä¸€ server_nameï¼ˆé€‚åˆå¤šç«™ç‚¹ï¼‰
è‹¥éœ€è¦ä¿ç•™é»˜è®¤é…ç½®ï¼Œä¿®æ”¹ downloads é…ç½®çš„ server_name ä¸ºæœåŠ¡å™¨çš„å±€åŸŸç½‘ IPï¼ˆå¦‚ 192.168.1.100ï¼‰ï¼Œé¿å…å†²çªï¼š
ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š
bash
Run

sudo nano /etc/nginx/sites-available/downloads

å°† server_name _; æ”¹ä¸ºæœåŠ¡å™¨çš„å®é™… IPï¼ˆå…ˆæ‰§è¡Œ ip a æŸ¥çœ‹å±€åŸŸç½‘ IPï¼Œå¦‚ 192.168.1.100ï¼‰ï¼š
nginx

server {
    listen 80;
    server_name 192.168.1.100;  # æ›¿æ¢ä¸ºä½ çš„æœåŠ¡å™¨å±€åŸŸç½‘IP
    root /srv/http-downloads;
    autoindex on;

    location / {
        try_files $uri $uri/ =404;
    }
}

ä¿å­˜åéªŒè¯é…ç½®å¹¶é‡å¯ Nginxï¼š
bash
Run

sudo nginx -t
sudo systemctl restart nginx